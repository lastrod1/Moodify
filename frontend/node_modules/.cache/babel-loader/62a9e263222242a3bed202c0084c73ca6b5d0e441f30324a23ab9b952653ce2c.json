{"ast":null,"code":"var _jsxFileName = \"/Users/minhtran/Desktop/College stuff/7th Semester (Fall 2024)/Databases (CS665)/Project/Moodify/frontend/src/pages/ProfilePage.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useAuth } from './../hooks/authContext';\nimport { useNavigate } from 'react-router-dom';\nimport './../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ProfilePage() {\n  _s();\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [isUpdating, setIsUpdating] = useState(false);\n  const [message, setMessage] = useState('');\n  const {\n    user,\n    setUser\n  } = useAuth();\n  const navigate = useNavigate();\n  const handleProfileChange = async e => {\n    e.preventDefault();\n    setIsUpdating(true);\n    setMessage('');\n    const updateData = {};\n    if (username.trim()) {\n      updateData.username = username.trim();\n    }\n    if (password.trim()) {\n      updateData.password = password.trim();\n    }\n    if (Object.keys(updateData).length === 0) {\n      setMessage('Please enter a new username or password');\n      setIsUpdating(false);\n      return;\n    }\n    try {\n      const response = await fetch('/api/auth/update', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': user.username\n        },\n        body: JSON.stringify(updateData)\n      });\n      const result = await response.json();\n      if (response.ok) {\n        setMessage(result.message);\n        if (result.new_username) {\n          setUser({\n            ...user,\n            username: result.new_username\n          });\n        }\n        setUsername('');\n        setPassword('');\n      } else {\n        setMessage(`Error: ${result.error || result.message}`);\n      }\n    } catch (error) {\n      console.error(\"Network or fetch error:\", error);\n      setMessage('An unexpected error occurred. Please try again.');\n    } finally {\n      setIsUpdating(false);\n    }\n  };\n  const handleProfileDelete = async e => {\n    const response = await fetch('/api/auth/delete', {\n      method: 'DELETE',\n      headers: {\n        'Authorization': user.username\n      }\n    });\n    navigate('/login');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"auth-page\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"auth-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"auth-header\",\n        children: \"Profile Change\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"auth-form\",\n        onSubmit: handleProfileChange,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Username\",\n          className: \"auth-input\",\n          value: username,\n          onChange: e => setUsername(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"Password\",\n          className: \"auth-input\",\n          value: password,\n          onChange: e => setPassword(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"auth-button\",\n          children: \"Change Credentials\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"delete-button\",\n        onClick: handleProfileDelete,\n        children: \"Delete Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s(ProfilePage, \"p+pVUBf02dW4pIDc4d3Y80/wtKw=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = ProfilePage;\nexport default ProfilePage;\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["React","useState","useAuth","useNavigate","jsxDEV","_jsxDEV","ProfilePage","_s","username","setUsername","password","setPassword","isUpdating","setIsUpdating","message","setMessage","user","setUser","navigate","handleProfileChange","e","preventDefault","updateData","trim","Object","keys","length","response","fetch","method","headers","body","JSON","stringify","result","json","ok","new_username","error","console","handleProfileDelete","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","placeholder","value","onChange","target","onClick","_c","$RefreshReg$"],"sources":["/Users/minhtran/Desktop/College stuff/7th Semester (Fall 2024)/Databases (CS665)/Project/Moodify/frontend/src/pages/ProfilePage.js"],"sourcesContent":["import React, { useState } from 'react'\nimport { useAuth } from './../hooks/authContext'\nimport { useNavigate } from 'react-router-dom';\nimport './../App.css'\nfunction ProfilePage() {\n    const [username, setUsername] = useState('');\n    const [password, setPassword] = useState('');\n    const [isUpdating, setIsUpdating] = useState(false);\n    const [message, setMessage] = useState('')\n    const { user, setUser } = useAuth();\n    const navigate = useNavigate();\n\n\n    const handleProfileChange = async (e) => {\n        e.preventDefault();\n        setIsUpdating(true);\n        setMessage('')\n\n        const updateData = {};\n        if(username.trim()){\n            updateData.username = username.trim();\n        }\n        if(password.trim()){\n            updateData.password = password.trim();\n        }\n\n        if(Object.keys(updateData).length === 0) {\n            setMessage('Please enter a new username or password');\n            setIsUpdating(false);\n            return;\n        }\n\n        try {\n            const response = await fetch('/api/auth/update', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': user.username\n                },\n                body: JSON.stringify(updateData),\n            });\n\n            const result = await response.json();\n            if(response.ok) {\n                setMessage(result.message);\n                \n                if(result.new_username) {\n                    setUser({ ...user, username: result.new_username})\n                }\n\n                setUsername('');\n                setPassword('');\n            } else {\n                setMessage(`Error: ${result.error || result.message}`);\n            }\n        } catch(error) {\n            console.error(\"Network or fetch error:\", error);\n            setMessage('An unexpected error occurred. Please try again.');\n        } finally {\n            setIsUpdating(false);\n        }\n    }\n\n    const handleProfileDelete = async (e) => {\n        const response = await fetch('/api/auth/delete', {\n            method: 'DELETE',\n            headers: {\n                'Authorization': user.username\n            },\n        });\n        navigate('/login');\n    }\n\n  return (\n    <div className='auth-page'>\n        <div className='auth-card'>\n            <h2 className='auth-header'>Profile Change</h2>\n            <form className='auth-form' onSubmit={handleProfileChange}>\n            <input\n                type=\"text\"\n                placeholder='Username'\n                className=\"auth-input\"\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n            />\n\n            <input\n                type=\"text\"\n                placeholder='Password'\n                className=\"auth-input\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n            />\n\n            <button type=\"submit\" className='auth-button'>\n                Change Credentials\n            </button>\n            </form>\n            <button className='delete-button' onClick={handleProfileDelete}>\n                Delete Account\n            </button>\n        </div>\n    </div>\n  )\n}\n\nexport default ProfilePage"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}